<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="`swi #0x10`: Decompresses bit-packed elements."><meta name="keywords" content="rust, rustlang, rust-lang, BitUnPack"><title>BitUnPack in gba2k::bios - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../main.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../gba2k/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../gba2k/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><div class="sidebar-elems"><h2 class="location"><a href="index.html">In gba2k::bios</a></h2></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../gba2k/index.html"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><button type="button">?</button></div><div id="settings-menu" tabindex="-1">
                                <a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../wheel.svg"></a></div>
                        </div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Function <a href="../index.html">gba2k</a>::<wbr><a href="index.html">bios</a>::<wbr><a class="fn" href="#">BitUnPack</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../src/gba2k/bios/x10.rs.html#79-88">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust fn"><code>pub unsafe fn BitUnPack(src: *const u8, dest: *mut u32, info: &amp;<a class="struct" href="struct.BitUnpackInfo.html" title="struct gba2k::bios::BitUnpackInfo">BitUnpackInfo</a>)</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p><code>swi #0x10</code>: Decompresses bit-packed elements.</p>
<p>Normally we have one <em>element</em> (unit of data) per <em>index</em> within a slice.
For compression purposes elements can be “bit-packed” so that more than one
element is in a single byte.</p>
<ul>
<li>This decompression processes each source byte as being one or more source
elements.</li>
<li>Source elements can be 1,  2, 4, or 8 bits big. When source elements are
less than 8 bits each they’re stored in a byte from the low bits to the
high bits.</li>
<li>The unpacking info supplies an “offset” value which is added to all source
elements with a non-zero value. The unpack info can also specify for the
offset to be added to source elements that are zero. This creates a
destination element.</li>
<li>Each destination element is 1, 2, 4, 8, 16, or 32 bits big. When
destination elements are less than 32 bits each they’re placed into the
output buffer from the low bits to the high bits.</li>
<li>Destination elements are collected into the output buffer until there’s 32
bits of output stored, and then that word is written to the destination
slice.</li>
<li>This means that the number of required destination indexes depends on the
number of source bytes, the bits per source element, and the bits per
destination element.</li>
</ul>
<h3 id="edge-cases"><a href="#edge-cases">Edge Cases</a></h3>
<ul>
<li><strong>If the number of source elements does not fully fill the output
buffer:</strong> the final, partial output buffer <em>will not</em> be written.</li>
<li><strong>If a source element plus the offset overflows the number of bits in a
destination element:</strong> elements are combined in the output buffer using
<code>bitor</code> and shifting. If destination elements overflow they can corrupt
the value of following elements in the same output buffer chunk.</li>
</ul>
<h3 id="safety"><a href="#safety">Safety</a></h3>
<ul>
<li>The <code>src</code> must be readable for the number of bytes given in
<code>info.src_len_bytes</code></li>
<li>The <code>dest</code> must be aligned and writable for an appropriate amount of
indexes. The required number of indexes varies based on the <code>info</code>
configuration and the number of <code>src</code> bytes.</li>
<li><code>info.src_elem_bits</code> must be 1, 2, 4, or 8.</li>
<li><code>info.dest_elem_bits</code> must be 1, 2, 4, 8, 16, or 32.</li>
</ul>
</div></details></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="gba2k" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.64.0-nightly (2f3ddd9f5 2022-06-27)" ></div>
</body></html>